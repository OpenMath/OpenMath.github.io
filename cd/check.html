<!DOCTYPE html>
<!--
OpenMath Validatior
Copyright 2017 David Carlisle
The HTML and Javascript OpenMath Validation code in ths file was written
by David Carlisle, it may be used, distributed and modified without
restriction other than any restrictions required by appropriate laws.
-->
<html>
 <head>
  <title>OpenMath Validation</title>
  <meta charset="UTF-8"/>
  <style>
    .err {color: red}
    span.ome {border: solid thin red}
   .indent{margin-left:2em;}
    .indent p {margin:0em;padding:0em;}

    @media (max-width:50em) {
    #cdinwrapper{width:95%;}
    #cdoutwrapper{width:95%;}
    }
    @media (min-width:50em) {
    #cdinwrapper{width:47%;}
    #cdoutwrapper{width:47%;}
    }
    
  </style>
  <script>

   // file drop

function dodrop(event) {
    var dt = event.dataTransfer;
    var files = dt.files;
    if(files.length == 1) {
	var fr = new FileReader();
	fr.onload = function(e) {
	    document.getElementById("cdin").textContent=e.target.result;
	};
	fr.readAsText(files[0]);
    } else {
	//        cdout.innerHTML =
	cdouttext =
	"only drop one file at a time";
    }      
}


// end of file drop code

// namespaces
var cdns="http://www.openmath.org/OpenMathCD";
var cdsns="http://www.openmath.org/OpenMathCDS";
var cdgns="http://www.openmath.org/OpenMathCDG";
var omns="http://www.openmath.org/OpenMath";

// regular expressions
   
// ascii version for now
var omNameRE= new RegExp(/^\s*[^0-9\.!@#:;<>()+=,%\$"'?/\\|{}\[\] \t\n\r][^\.!@#:;<>()+=,%\$"'?/\\|{}\[\] \t\n\r]*\s*$/);
var omURLRE= new RegExp(/^\s*[a-z]+:\/\/[^ ]*\s*$/);
var omDateRE= new RegExp(/^\s*[0-9]{4}-(0[1-9]|1[12])-(0[1-9]|[12][0-9]|3[01])\s*$/);


// code for the check button
function checkcd () {
    var cdout=document.getElementById("cdout");
    var sMyString = document.getElementById("cdin").textContent;

    var oParser = new DOMParser();

    var oDOM = oParser.parseFromString(sMyString, "text/xml");
    if (oDOM.getElementsByTagName("parsererror").length>0) {
	var x= oDOM.getElementsByTagName("parsererror")[0].textContent;
	cdouttext =
//	cdout.innerHTML =
	    "<h3>XML Parse Error</h3><pre class='err'>\n" +
	    oDOM.getElementsByTagName("parsererror")[0].textContent.replace(/&/g,'&amp;').replace(/</g,'&lt;') +"</pre>";
    } else {
	cdouttext =
	    //	cdout.innerHTML =
	    "";
	vroot(oDOM);
    }
    cdout.innerHTML=cdouttext;
    cdouttext="";
	if (document.getElementsByClassName!=undefined) {
            var errs=document.getElementsByClassName('err').length
	    var cdoutwrapper=document.getElementById("cdoutwrapper");
	    var errcount=document.getElementById("errcount");
	    if(errs==0) {
		cdoutwrapper.style.borderColor='green';
		cdoutwrapper.style.borderWidth='.2em';
		errcount.textContent='';
	    } else {
		cdoutwrapper.style.borderColor='red';
		cdoutwrapper.style.borderWidth='.2em';
		errcount.textContent=' (' +errs +' error' + (errs==1? '':'s') +' found)';
	    }
	}
    
}


// functions v* validate their input and place results in the output div
// functions vs* same but return a string
// some of the duplication here will be removed later, gradually moving to vs versions

function vroot (o) {
    var els=vChildren(o)
    if (els.length==1) {
	if (els[0].namespaceURI==cdns) {
	    if (els[0].localName=="CD") {
		vCD(els[0]);
	    } else {
	cdouttext = cdouttext
		//		cdout.innerHTML = cdout.innerHTML
		    + "<p class='err'>Bad root element: should be CD</p>";
	    }
	} else if (els[0].namespaceURI == cdsns) {
	    if (els[0].localName=="CDSignatures") {
		vCDSignatures(els[0]);
	    } else {
		cdouttext = cdouttext
		// cdout.innerHTML = cdout.innerHTML
		    + "<p class='err'>Bad root element: should be CDSignatures</p>";
	    }
	} else if (els[0].namespaceURI==cdgns) {
	    if (els[0].localName=="CDGroup") {
		vCDGroup(els[0]);
	    } else {
		cdouttext = cdouttext
		// cdout.innerHTML = cdout.innerHTML
		    + "<p class='err'>Bad root element: should be CDGroup</p>";
	    }
	} else if (els[0].namespaceURI == omns) {
	    if (els[0].localName=="OMOBJ") {
		vOMOBJ(els[0]);
	    } else {
		cdouttext = cdouttext
		// cdout.innerHTML = cdout.innerHTML
		    + "<p class='err'>Bad root element: should be OMOBJ</p>";
	    }
	} else {
	    cdouttext = cdouttext
	    // cdout.innerHTML = cdout.innerHTML
		+ "<p class='err'>Bad root namespace:<br>" +
		els[0].namespaceURI + "<br><br>This tool can only validate XML using the following namespaces:<br>  " +
		cdns + "<br>  " +
		cdgns + "<br>  " +
		cdsns + "<br>  " +
		omns + 
		"</p>";
	}
    } else {
	cdouttext = cdouttext
	// cdout.innerHTML = cdout.innerHTML
	    + "<p class='err'`c>multiple root elements</p>";
    }
}

function vCDGroup(e) {
    err="";
    u="";
    err += vNoAttributes(e);
    err+=vsNoText(e);
    vOut(err,"<b>OpenMath Content Dictionary Group File</b>");
    cdouttext = cdouttext
    //    cdout.innerHTML = cdout.innerHTML
	+ u;
    var els=vChildren(e);
    var CDGNamec=0;
    var CDGURLc=0;
    var CDGVersionc=0;
    var CDGRevisionc=0;
    for(var j=0;j<els.length;j++){
	var c=els[j];
	switch(c.localName) {
	case "CDGroupName":
	    vTextOne(c,++CDGNamec,omNameRE);
	    break;
	case "CDGroupDescription":
	    vDescription(c);
	    break;
	case "CDGroupVersion":
	    vTextOne(c,++CDGVersionc,/^\s*[0-9]+\s*$/);
	    break;
	case "CDGroupRevision":
	    vTextOne(c,++CDGRevisionc,/^\s*[0-9]+\s*$/);
	    break;
	case "CDGroupURL":
	    vTextOne(c,++CDGURLc,omURLRE);
	    break;
	case "CDComment":
	    vCDComment(c);
	    break;
	case "CDSStatus":
	    vTextOne(c,++CDSStatusc,/^\s*(official|experimental|private|obsolete)\s*$/);
	    break;
	case "CDGroupMember":
	    vCDGroupMember(c);
	    break;
	default:
	    vErr(c);
	}
    }
}


function vCDGroupMember (e) {
    var err="";
    err += vNoAttributes(e);
    vOut(err,"<b>CDGroupMember:</b>");
    var u= "<div class='indent'>";
    var els=vChildren(e);
    var j=0;
    if (els.length>j && els[j].localName=='CDComment') {
	u+=vsCDComment(els[j]);
	j++;
    }
    if (els.length>j && els[j].localName=='CDName') {
	u+=vsTextOne(els[j],1,omNameRE);
	j++;
    } else {
	vsErr(els[j]);
    }
    if (els.length>j && els[j].localName=='CDVersion') {
	u+=vsTextOne(els[j],1,/^\s*[0-9]+\s*$/);
	j++;
    }
    if (els.length>j && els[j].localName=='CDURL') {
	u+=vsTextOne(els[j],1,omURLRE);
	j++;
    }
    if (els.length>j) {
	u+=vsErr(els[j]);
    }
    u+="</div>";
    cdouttext = cdouttext
    //    cdout.innerHTML = cdout.innerHTML
	+ u;
}

function vCDSignatures(e) {
    err="";
    u="";
    var ty="";
    var cd="";
    var tyc=0;
    var cdc=0;
    var atts=e.attributes;
    for(var j=0;j<atts.length;j++) {
	switch(atts[j].localName) {
	case "xmlns":
	    break;
	case "type":
	    tyc++;
	    ty=atts[j].value;
	    u+=vsOut(ty.match(omNameRE)?"":" (Invalid type)","<b>Type:</b> " + atts[j].value); 
	    break;
	case "cd":
	    cdc++;
	    cd=atts[j].value;
	    u+=vsOut(cd.match(omNameRE)?"":" (Invalid CD name)","<b>CD:</b> " + atts[j].value); 
	    break;
	default:
	    if(! atts[j].name.startsWith("xmlns:")) {
		err+=" (Unexpected attribute: " + atts[j].localName +")";
	    }
	}
    }
    if (tyc==0) err += " (Missing attribute: type)";
    if (cdc==0) err += " (Missing attribute: cd)";
    err+=vsNoText(e);
    vOut(err,"<b>OpenMath Content Dictionary Signature File</b>");
    cdouttext = cdouttext
    //    cdout.innerHTML = cdout.innerHTML
	+ u;
    var els=vChildren(e);
    var CDSStatusc=0;
    var CDSRDatec=0;
    var CDSRevisionc=0;
    for(var j=0;j<els.length;j++){
	var c=els[j];
	switch(c.localName) {
	case "CDSComment":
	    vCDSComment(c);
	    break;
	case "CDSStatus":
	    vTextOne(c,++CDSStatusc,/^\s*(official|experimental|private|obsolete)\s*$/);
	    break;
	case "CDSReviewDate":
	    vTextOne(c,++CDSRDatec,omDateRE);
	    break;
	case "Signature":
	    vSignature(c);
	    break;
	default:
	    vErr(c);
	}
    }
}

function vCD(e) {
    var err="";
    err += vNoAttributes(e);
    err+=vsNoText(e);
    vOut(err,"<b>OpenMath Content Dictionary</b>");
    var els=vChildren(e);
    var CDNamec=0;
    var CDURLc=0;
    var CDBasec=0;
    var CDRDatec=0;
    var CDDatec=0;
    var CDStatusc=0;
    var CDVersionc=0;
    var CDRevisionc=0;
    for(var j=0;j<els.length;j++){
	var c=els[j];
	switch(c.localName) {
	case "CDComment":
	    vCDComment(c);
	    break;
	case "Description":
	    vDescription(c);
	    break;
	case "CDName":
	    vTextOne(c,++CDNamec,omNameRE);
	    break;
	case "CDURL":
	    vTextOne(c,++CDURLc,omURLRE);
	    break;
	case "CDBase":
	    vTextOne(c,++CDBasec,omURLRE);
	    break;
	case "CDReviewDate":
	    vTextOne(c,++CDRDatec,omDateRE);
	    break;
	case "CDDate":
	    vTextOne(c,++CDDatec,omDateRE);
	    break;
	case "CDStatus":
	    vTextOne(c,++CDStatusc,/^\s*(official|experimental|private|obsolete)\s*$/);
	    break;
	case "CDUses":
	    vCDuses(c);
	    break;
	case "CDVersion":
	    vTextOne(c,++CDVersionc,/^\s*[0-9]+\s*$/);
	    break;
	case "CDRevision":
	    vTextOne(c,++CDRevisionc,/^\s*[0-9]+\s*$/);
	    break;
	case "CDDefinition":
	    vCDDefinition(c);
	    break;
	default:
	    vErr(c);
	}
    }
}



function vChildren(n) {
    var c=[];
    for(var j=0;j<n.childNodes.length; j++ ) {
	if(n.childNodes[j].nodeType==1) {
	    c[c.length]=n.childNodes[j];
	}
    }
    return c;
}

function vErr(c) {
    vOut("(Unexpected element: " +c.localName + ")","");
}

function vsErr(c) {
    return vsOut("(Unexpected element: " +c.localName + ")","");
}
function vsSpanErr(c) {
    return vsSpanOut("(Unexpected element: " +c.localName + ")","");
}

function vTextOnly(e) {
    var c=vChildren(e);
    return (c.length==0 ? "" : " (Unexpected element: " + c[0].localName + ")");
}

function vNoAttributes(e) {
    var atts = e.attributes;
    var err="";
    for (var j=0;j<atts.length;j++){
	if(atts[j].localName!='xmlns' && (!atts[j].name.startsWith("xmlns:")))
	   err += " (Unexpected attribute: " + atts[j].localName + ")";
    }
    return err;
}


function vsNoText(n) {
    var els=n.childNodes;
    var err="";
    for(var j=0;j<els.length; j++ ) {
	if(els[j].nodeType==3 && (! els[j].nodeValue.match(/^\s*$/))) err+=" (Unexpected text: " + els[j].nodeValue +")";
    }
    return err;
}
    

function vOut(err,t){
    cdouttext = cdouttext
    //    cdout.innerHTML = cdout.innerHTML
	+ "<p" + (err=="" ? "": " class='err'") +">" + t + err + "</p>";
}

function vsOut(err,t){
    return ("<p" + (err=="" ? "": " class='err'") +">" + t + err + "</p>");
}

function vsSpanOut(err,t){
    return ("<span" + (err=="" ? "": " class='err'") +">" + t + err + "</span>");
}

function vTestRE(e,r) {
    return (e.textContent.match(r) ? "" : " (Invalid text)");
}

function vCDComment (e) {
    var err="";
    err += vNoAttributes(e);
    err += vTextOnly(e);
    vOut(err,"<b>CDComment:</b>");
    if(err=="") {
	cdouttext = cdouttext
	//	cdout.innerHTML = cdout.innerHTML
	    +"<pre>" +e.innerHTML +"</pre>";
    }
}

function vsCDComment (e) {
    var err="";
    err += vNoAttributes(e);
    err += vTextOnly(e);
    var u = vsOut(err,"<b>CDComment:</b>");
    if(err=="") u+= "<pre>" +e.innerHTML +"</pre>";
    return u;
}

function vCDSComment (e) {
    var err="";
    err += vNoAttributes(e);
    err += vTextOnly(e);
    vOut(err,"<b>CDSComment:</b>");
    if(err==""){
	cdouttext = cdouttext
	//	cdout.innerHTML = cdout.innerHTML
	    +"<pre>" +e.innerHTML +"</pre>";
    }
}

function vDescription (e) {
    var err="";
    err += vNoAttributes(e);
    vOut(err,"<b>Description:</b>");
    cdouttext = cdouttext
    //    cdout.innerHTML = cdout.innerHTML
	+"<div> " +e.innerHTML + "</div>";
}

function vTextOne(e,ct,re) {
    var err="";
    err += vNoAttributes(e);
    err += vTextOnly(e);
    if (ct != 1) err += " (Multiple " + e.localName +")";
    err += vTestRE(e,re);
    vOut(err,"<b>" + e.localName + ":</b> " +e.innerHTML);
}

function vsTextOne(e,ct,re) {
    var err="";
    err += vNoAttributes(e);
    err += vTextOnly(e);
    if (ct != 1) err += " (Multiple " + e.localName +")";
    err += vTestRE(e,re);
    return vsOut(err,"<b>" + e.localName + ":</b> " +e.innerHTML);
}


function vCDuses (e) {
    var err="";
    err += vNoAttributes(e);
    err+=vsNoText(e);
    vOut(err,"<b>CDUses:</b>");
    var u= "<div class='indent'>";
    var els=vChildren(e);
    for(var j=0;j<els.length;j++){
	var c=els[j];
	if (c.localName=='CDName') {
	    u+=vsTextOne(c,1,omNameRE);
	} else {
	    u+=vsErr(c);
	}
    }
    u+="</div>";
    cdouttext = cdouttext
    //    cdout.innerHTML = cdout.innerHTML
	+ u;
}





function vExample (e) {
    var u="";
    var err="";
    err += vNoAttributes(e);
    u+=vsOut(err,"<b>Example:</b>");
    if(err==""){
	var els=e.childNodes;
	for(var j=0;j<els.length;j++){
	    var c=els[j];
	    if(c.nodeType==3) {
		u+=c.nodeValue;
	    } else if (c.nodeType==1) {
		u+=vsOMOBJ(c);
	    }
	}
    }
    cdouttext = cdouttext
    //    cdout.innerHTML = cdout.innerHTML
	+ u;
}


function vFMP (e) {
    var err="";
    var k="";
    var atts=e.attributes;
    for(var j=0;j<atts.length;j++){
	if(atts[j].localName="kind"){
	    k= " (" + atts[j].value +")";
	} else {
	    err += " (Unexpected attribute: " + atts[j].localName +")";
	}
    }
    err+=vsNoText(e);
    vOut(err, "<b>FMP" + k +":</b>");
    if(err=="") {
	var u= "<div class='indent'>";
	var els=vChildren(e);
	if(els.length==0) {
	    u+="<p class='err'>Missing element: OMOBJ</p>";
	} else if (els.length==1) {
	    u+=vsOMOBJ(els[0]);
	} else {
	    u+=vsErr(els[1]);
	}
	u+="</div>";
	cdouttext = cdouttext
	//	cdout.innerHTML = cdout.innerHTML
	    + u;
    }
}

function vSignature (e) {
    var err="";
    var k="";
    var atts=e.attributes;
    for(var j=0;j<atts.length;j++){
	if(atts[j].localName="name"){
	    k= " (" + atts[j].value +")";
	    err+=atts[j].value.match(omNameRE)?"":" (Invalid name)";
	} else {
	    err += " (Unexpected attribute: " + atts[j].localName +")";
	}
    }
    err+=vsNoText(e);
    vOut(err, "<b>Signature" + k +":</b>");
    if(err=="") {
	var u= "<div class='indent'>";
	var els=vChildren(e);
	if(els.length==0) {
	    u+="<p class='err'>Missing element: OMOBJ</p>";
	} else if (els.length==1) {
	    u+=vsOMOBJ(els[0]);
	} else {
	    u+=vsErr(els[1]);
	}
	u+="</div>";
	cdouttext = cdouttext
	//	cdout.innerHTML = cdout.innerHTML
	    + u;
    }
}


function vCDDefinition (e) {
    var err="";
    err += vNoAttributes(e);
    err+=vsNoText(e);
    vOut(err,"<b>CDDefinition:</b>");
    if(err==""){
	var Namec=0;
	var Rolec=0;
	var Descriptionc=0;
	var els=vChildren(e);
	for(var j=0;j<els.length;j++){
	    var c=els[j];
	    switch(c.localName) {
	    case "Name":
		vTextOne(c,++Namec,omNameRE);
		break;
	    case "Role":
		vTextOne(c,++Rolec,/^\s*(binder|attribution|semantic-attribution|error|application|constant)\s*$/);
		break;
	    case "CDComment":
		vCDComment(c);
		break;
	    case "Description":
		vTextOne(c,++Descriptionc,/./);
		break;
	    case "Example":
		vExample(c);
		break;
	    case "FMP":
		vFMP(c);
		break;
	    case "CMP":
		vTextOne(c,1,/./);
		break;
	    default:
		vErr(c);
	    }
	}
    }
}

function vOMOBJ(e) {
    var err="";
    var atts=e.attributes;
    for(var j=0;j<atts.length;j++) {
	switch(atts[j].localName) {
	case "id":
	case "version":
	case "cdbase":
	case "xmlns":
	    break;
	default:
	    if(! atts[j].name.startsWith("xmlns:")) {
		err+=" (Unexpected attribute: " + atts[j].localName +")";
	    }
	}
    }
    vOut(err,"<b>OpenMath Object</b>");
    var els=vChildren(e);
    if (els.length = 1) {
	cdouttext = cdouttext
	//	cdout.innerHTML = cdout.innerHTML
	    + "<div>"+ vsOMel(els[0])+ "</div>";
    } else if (els.length=0) {
	vOut("(Empty OMOBJ)","");
    } else {
	vOut(" (Unexpected element)", els[1].localName);
    }
}

function vsOMel (c) {
    var u="";
    switch(c.localName) {
    case "OMS":
	u=vsOMS(c);
	break;
    case "OMV":
	u=vsOMV(c);
	break;
    case "OMI":
	u=vsOMI(c);
	break;
    case "OMB":
	u=vsOMB(c);
	break;
    case "OMSTR":
	u=vsOMSTR(c);
	break;
    case "OMF":
	u=vsOMF(c);
	break;
    case "OMA":
	u=vsOMA(c);
	break;
    case "OMBIND":
	u=vsOMBIND(c);
	break;
    case "OME":
	u=vsOME(c);
	break;
    case "OMATTR":
	u=vsOMATTR(c,false);
	break;
    case "OMR":
	u=vsOMR(c);
	break;
    default:
	u=vsSpanErr(c);
    }
    return u;
}

function vsOMA(e) {
    var u="";
    var err="";
    var atts=e.attributes;
    for(var j=0;j<atts.length;j++) {
	switch(atts[j].localName) {
	case "id":
	case "cdbase":
	    break;
	default:
	    err+=" (Unexpected attribute: " + atts[j].localName +")";
	}
    }
    err+=vsNoText(e);
    var els=vChildren(e);
    for(var j=0;j<els.length;j++){
	var c = els[j];
	u+=vsOMel(c);
	if(j==0){
	    u+= "(";
	} else if (j<els.length -1) {
	    u+=", ";
	}
    }
    u+=")";
    return vsSpanOut(err,u);
}

function vsOMSTR(e) {
    var err="";
    var atts=e.attributes;
    for(var j=0;j<atts.length;j++) {
	switch(atts[j].localName) {
	case "id":
	    break;
	default:
	    err+=" (Unexpected attribute: " + atts[j].localName +")";
	}
    }
    if (e.childNodes.length != 1) {
	err += " (Unexpected content in OMSTR)";
    }
    return vsSpanOut(err, "<tt>\""+e.innerHTML + "\"</tt>");
}


function vsOMI(e) {
    var err="";
    var atts=e.attributes;
    for(var j=0;j<atts.length;j++) {
	switch(atts[j].localName) {
	case "id":
	    break;
	default:
	    err+=" (Unexpected attribute: " + atts[j].localName +")";
	}
    }
    if (e.childNodes.length != 1) {
	err += " (Unexpected content in OMI)";
    }
    if(! e.textContent.match(/^\s*(-\s?)?[0-9]+(\s[0-9]+)*\s*$/)) {
	err += " (Invalid Integer)";
    }
    return vsSpanOut(err, e.textContent);
}

function vsOMB(e) {
    var err="";
    var atts=e.attributes;
    for(var j=0;j<atts.length;j++) {
	switch(atts[j].localName) {
	case "id":
	    break;
	default:
	    err+=" (Unexpected attribute: " + atts[j].localName +")";
	}
    }
    if (e.childNodes.length != 1) {
	err += " (Unexpected content in OMB)";
    }
    if(! e.textContent.match(/^[ \t\r\na-zA-Z0-9\+/]*=*\s*$/)) {
	err += " (Invalid base64)";
    }
    return vsSpanOut(err, "<i>OMB</i>");
}

function vsOMV(e) {
    var err="";
    var v="";
    var atts=e.attributes;
    if(atts.length!=1 || atts[0].localName != "name") {
	err =" (Invalid OMV attributes)";
    } else {
	v=atts[0].value;
	err+=(v.match(omNameRE)?"":" (Invalid name)");
    }
    return "<i>" + vsSpanOut(err,v) + "</i>";
}

function vsOMF(e) {
    var err="";
    var d="";
    var h="";
    var atts=e.attributes;
    for(var j=0;j<atts.length;j++) {
	switch(atts[j].localName) {
	case "id":
	    break;
	case "dec":
	    if(h=="") {
		d=atts[j].value;
		err+=(d.match(/^\s*-?[0-9]*(\.[0-9]+)?([eE]-?[0-9]*(\.[0-9]+)?)?\s*$/)?"":" (Invalid Decimal)");
	    } else {
		err+=" (Unexpected dec attribute)";
	    }
	    break;
	case "hex":
	    if(d=="") {
		h=atts[j].value;
		err+=(h.match(/^\s*[0-9A-F]+\s*$/)?"":" (Invalid hex number)");
	    } else {
		err+=" (Unexpected hex attribute)";
	    }
	    break;
	default:
	    err+=" (Unexpected attribute: " + atts[j].localName +")";
	}
    }
    if (e.childNodes.length != 0) {
	err += " (Unexpected content in OMF)";
    }
    return vsSpanOut(err,h+d);
}


function vsOMS(e) {
    var err="";
    var n="";
    var cd="";
    var nc=0;
    var cdc=0;
    var atts=e.attributes;
    for(var j=0;j<atts.length;j++) {
	switch(atts[j].localName) {
	case "id":
	case "cdbase":
	    break;
	case "name":
	    nc++;
	    n=atts[j].value;
	    err+=(n.match(omNameRE)?"":" (Invalid name)");
	    break;
	case "cd":
	    cdc++;
	    cd=atts[j].value;
	    err+=(cd.match(omNameRE)?"":" (Invalid name)");
	    break;
	default:
	    err+=" (Unexpected attribute: " + atts[j].localName +")";
	}
    }
    if (e.childNodes.length != 0) {
	err += " (Unexpected content in OMS)";
    }
    if (nc==0) err += " (Missing attribute: name)";
    if (cdc==0) err += " (Missing attribute: cd)";
    if(err=="") {
	return ("<a href='../cd/" + cd +"'>" + n + "</a>");
    } else {
	return vsSpanOut(err,n);
    }
}

function vsOMBIND(e) {
    var err="";
    var u="";
    var cd="";
    var atts=e.attributes;
    for(var j=0;j<atts.length;j++) {
	switch(atts[j].localName) {
	case "id":
	case "cdbase":
	    break;
	default:
	    err+=" (Unexpected attribute: " + atts[j].localName +")";
	}
    }
    err+=vsNoText(e);
    var els=vChildren(e);
    if(els.length==3) {
	u +="(";
	u+=vsOMel(els[0]);
	u+="[";
	u+=vsOMBVAR(els[1]);
	u+="] . ";
	u+=vsOMel(els[2]);
	u+=")";
    } else {
	err += "(OMBIND should have 3 children)";
    }
    return vsSpanOut(err,u);
}


function vsOMFOREIGN(e) {
    var err="";
    var u="<i>omforeign</i>(";
    var atts=e.attributes;
    for(var j=0;j<atts.length;j++) {
	switch(atts[j].localName) {
	case "id":
	case "cdbase":
	case "encoding":
	    break;
	default:
	    err+=" (Unexpected attribute: " + atts[j].localName +")";
	}
    }
    var els=vChildren(e);
    for(var j=0;j<els.length;j++) {
	var c=els[j];
	if(j!=0) u+=", ";
	if(c.namespaceURI==omns) {
	    u+=vsOMel(c);
	} else {
	    u+="<i>foreign</i>";
	}
    }
    return vsSpanOut(err,u);
}


function vsOME(e) {
    var err="";
    var atts=e.attributes;
    for(var j=0;j<atts.length;j++) {
	switch(atts[j].localName) {
	case "id":
	    break;
	default:
	    err+=" (Unexpected attribute: " + atts[j].localName +")";
	}
    }
    err+=vsNoText(e);
    var els=vChildren(e);
    var u = "<span class='ome'>Error( ";
    if (els.length == 0||els[0].localName!="OMS") {
	err += " (Missing element OMS)";
    } else {
        u+=vsOMS(els[0]);
    }
    for(var j = 1; j<els.length;j++) {
	u+= (j==1? ": " : ", ");
	u+=vsOMel(els[j]);
    }
    u +=")</span>";
    return vsSpanOut(err,u);
}

function vsOMOBJ(e) {
    var err="";
    var u="";
    if (e.localName=='OMOBJ' && e.namespaceURI==omns) {
	var atts=e.attributes;
	for(var j=0;j<atts.length;j++) {
	    switch(atts[j].localName) {
	    case "id":
	    case "version":
	    case "cdbase":
	    case "xmlns":
		break;
	    default:
		err+=" (Unexpected attribute: " + atts[j].localName +")";
	    }
	}
	err+=vsNoText(e);
	var els=vChildren(e);
	if (els.length = 1) {
	    u+=vsOMel(els[0]);
	} else if (els.length=0) {
	    err="(empty OMOBJ)";
	} else {
	    err="(Unexpected children in OMOBJ)";
	}
    } else {
	err="(Unexpected element {" + e.namespaceURI + "}" + e.localName + ")";
    }
    return vsSpanOut(err,u);
}

function vsOMATTR(e,bvar) {
    var err="";
    var u="";
    var cd="";
    var atts=e.attributes;
    for(var j=0;j<atts.length;j++) {
	switch(atts[j].localName) {
	case "id":
	case "cdbase":
	    break;
	default:
	    err+=" (Unexpected attribute: " + atts[j].localName +")";
	}
    }
    err+=vsNoText(e);
    var els=vChildren(e);
    if(els.length==2) {
	if(els[0].localName=='OMATP'){
	    var c=els[1];
	    u +="(";
	    if(bvar) {
		switch(c.localName) {
		case "OMV":
		    u+=vsOMV(c);
		    break;
		case "OMATTR":
		    u+=vsOMATTR(c,true);
		    break;
		default:
		    u+=vsSpanErr(c);
		}
            } else {
		u+=vsOMel(els[1]);
	    }
	    u+="[";
	    u+=vsOMATP(els[0]);
	    u+="])";
	} else {
	    err += "(OMBIND should have OMATP child)";
	}
    } else {
	err += "(OMBIND should have 2 children)";
    }
    return vsSpanOut(err,u);
}


function vsOMATP(e) {
    var err="";
    var u="";
    var atts=e.attributes;
    for(var j=0;j<atts.length;j++) {
	switch(atts[j].localName) {
	case "id":
	case "version":
	case "cdbase":
	case "xmlns":
	    break;
	default:
	    err+=" (Unexpected attribute: " + atts[j].localName +")";
	}
    }
    err+=vsNoText(e);
    var els=vChildren(e);
    if(els.length%2 !=0) {
	err+="( Unpaired attribute)";
    }
    for(var j=0;j<els.length;j=j+2){
	var c = els[j];
	var v = els[j+1];
	if(c.localName=="OMS"){
	    if(j!=0) u+=", ";
	    u+=vsOMS(c);
	    u+=": ";
	    if(v.localName=='OMFOREIGN') {
		u+=vsOMFOREIGN(v);
	    } else {
		u+=vsOMel(v);
	    }
	} else {
	    u+="<span class='err'>?? (Unexpected attribute)</span>";
	}
    }
    return vsSpanOut(err,u);
}

function vsOMBVAR(e) {
    var err="";
    var u = "";
    var atts=e.attributes;
    for(var j=0;j<atts.length;j++) {
	switch(atts[j].localName) {
	case "id":
	    break;
	default:
	    err+=" (Unexpected attribute: " + atts[j].localName +")";
	}
    }
    err+=vsNoText(e);
    var els=vChildren(e);
    for(var j = 0; j<els.length;j++) {
	var c=els[j];
	u+= (j>0? ", " : "");
	switch(c.localName) {
	case "OMV":
	    u+=vsOMV(c);
	    break;
	case "OMATTR":
	    u+=vsOMATTR(c,true);
	    break;
	default:
	    u+=vsSpanErr(c);
	}
    }
    return vsSpanOut(err,u);
}


function vsOMR(e) {
    var err="";
    var h="";
    var atts=e.attributes;
    for(var j=0;j<atts.length;j++) {
	switch(atts[j].localName) {
	case "id":
	    break;
	case "href":
	    h=atts[j].value;
	    err+=(cd.match(omURLRE)?"":" (URL)");
	    break;
	default:
	    err+=" (Unexpected attribute: " + atts[j].localName +")";
	}
    }
    if (e.childNodes.length != 0) {
	err += " (Unexpected content in OMR)";
    }
    if(err=="") {
	return ("<a href='" + h +"'>ref</a>");
    } else {
	return vsSpanOut(err,n);
    }
}

function clearcdin() {
    document.getElementById("cdin").textContent="";
    var cdoutwrapper=document.getElementById("cdoutwrapper");
    document.getElementById("errcount").textContent="";
    cdout.textContent="";
    cdoutwrapper.style.borderColor='black';
    cdoutwrapper.style.borderWidth='thin';
}

function sampleom() {
document.getElementById("cdin").textContent='\n\
<OMOBJ xmlns="http://www.openmath.org/OpenMath" verrsion="2.0" cdbase="http://www.openmath.org/cd">\n\
  <OMA>\n\
    <OMS cd="relation1" name="="/>\n\
    <OMA>\n\
      <OMA>\n\
        <OMS cd="calculus1" name="diff"/>\n\
        <OMBIND>\n\
          <OMS cd="fns1" name="lambda"/>\n\
          <OMBVAR>\n\
            <OMV name="y"/>\n\
          </OMBVAR>\n\
          <OMA style="bad">\n\
            <OMS cd="arith1" name="plus"/>\n\
            <OMA>\n\
              <OMV name="a"/>\n\
              <OMV name="y"/>\n\
            </OMA>\n\
            <OMA>\n\
              <OMV name="b"/>\n\
              <OMV name="y"/>\n\
            </OMA>\n\
          </OMA>\n\
        </OMBIND>\n\
      </OMA>\n\
      <OMV name="x"/>\n\
    </OMA>\n\
    <OMA>\n\
      <OMS cd="arith1" name="plus"/>\n\
      <OMA>\n\
        <OMA>\n\
          <OMS cd="calculus1" name="diff"/>\n\
          <OMBIND>\n\
            <OMS cd="fns1" name="lambda"/>\n\
            <OMBVAR>\n\
              <OMV name="y"/>\n\
            </OMBVAR>\n\
            <OMA>\n\
              <OMV name="a"/>\n\
              <OMV name="y"/>\n\
            </OMA>\n\
          </OMBIND>\n\
        </OMA>\n\
        <OMV name="x"/>\n\
      </OMA>\n\
      <OMA>\n\
        <OMA>\n\
          <OMS cd="calculus1" name="diff"/>\n\
          <OMBIND>\n\
            <OMS cd="fns1" name="lambda"/>\n\
            <OMBVAR>\n\
              <OMV name="y"/>\n\
            </OMBVAR>\n\
            <OMA>\n\
              <OMV name="b"/>\n\
              <OMV name="y"/>\n\
            </OMA>\n\
          </OMBIND>\n\
        </OMA>\n\
        <OMV name="x"/>\n\
      </OMA>\n\
    </OMA>\n\
\n\
 <OMATTR>    \n\
  <OMATP>\n\
    <OMS cd="ecc" name="type" /> \n\
    <OMS cd="ecc" name="real" />\n\
    <OMS cd="sts" name="type" /> \n\
    <OMS cd="sts" name="integer" />\n\
  </OMATP> \n\
  <OMV name="x" />\n\
 </OMATTR>\n\
\n\
  <OMATTR>    \n\
  <OMATP>\n\
   <OMS cd="arith1" name="plus" />\n\
   <OMFOREIGN><w xmlns=""/><x xmlns=""><y/><z/></x></OMFOREIGN>\n\
  </OMATP> \n\
  <OMV name="x" />\n\
 </OMATTR>\n\
\n\
 <OMATTR>    \n\
  <OMATP>\n\
   <OMS cd="arith1" name="plus" />\n\
   <OMFOREIGN><w/><x><y/><z/></x></OMFOREIGN>\n\
  </OMATP> \n\
  <OMV name="x" />\n\
 </OMATTR>\n\
\n\
 <OMBIND>\n\
  <OMS name="forall" cd="quant1"/>\n\
  <OMBVAR>\n\
   <OMATTR>\n\
    <OMATP>\n\
     <OMS name="plus" cd="arith1"/>\n\
     <OMS name="plus" cd="arith1"/>\n\
    </OMATP>\n\
    <OMV name="x"/>\n\
   </OMATTR>\n\
  </OMBVAR>\n\
  <OMV name="x"/>\n\
 </OMBIND>\n\
 \n\
 <OMATTR>\n\
  <OMATP>\n\
   <OMS name="plus" cd="arith1"/>\n\
   <OMS name="plus" cd="arith1"/>\n\
  </OMATP>\n\
  <OMI>1</OMI>\n\
 </OMATTR>\n\
 \n\
 <OMBIND>\n\
  <OMS name="forall" cd="quant1"/>\n\
  <OMBVAR>\n\
   <OMATTR>\n\
    <OMATP>\n\
     <OMS name="plus" cd="arith1"/>\n\
     <OMS name="plus" cd="arith1"/>\n\
    </OMATP>\n\
    <OMI>1</OMI>\n\
   </OMATTR>\n\
  </OMBVAR>\n\
  <OMV name="x"/>\n\
 </OMBIND>\n\
\n\
 <OMI>77</OMI>\n\
\n\
 <OMI>77.9</OMI>\n\
 \n\
 <OMF dec="1.0"/>\n\
 <OMF dec="1e2"/>\n\
 <OMF dec="1E2"/>\n\
 <OMF dec="1e-2"/>\n\
 <OMF dec="-1e-2"/>\n\
 <OMF dec="1e 2"/>\n\
  </OMA>\n\
</OMOBJ>\n\
';
}

function samplecdg() {
document.getElementById("cdin").textContent='\n\
<CDGroup  xmlns="http://www.openmath.org/OpenMathCDG">\n\
<CDGroupName>mathml-x</CDGroupName>\n\
<CDGroupVersion> 2.1 </CDGroupVersion>\n\
<CDGroupRevision> b </CDGroupRevision>\n\
<CDGroupURL>http://www.openmath.org/cdfiles/cdgroups/mathml.ocd</CDGroupURL>\n\
<CDGroupDescription> MathML compatibility CD Group </CDGroupDescription>\n\
<CDComment>This is an abbreviated  MathML CD group.</CDComment>\n\
<CDComment>Algebra</CDComment>\n\
<CDGroupMember>\n\
<CDName>alg1</CDName>\n\
<CDURL>www.openmath.org/cd/alg1.ocd</CDURL></CDGroupMember>\n\
<CDComment>Arithmetic</CDComment>\n\
<CDGroupMember>\n\
<CDName>arith1</CDName>\n\
<CDURL>http://www.openmath.org/cd/arith1.ocd</CDURL></CDGroupMember>\n\
<CDComment>Constructor for Floating Point Numbers</CDComment>\n\
<CDGroupMember x="y">\n\
<CDName>bigfloat1</CDName>\n\
<CDURL>http://www.openmath.org/cd/bigfloat1.ocd</CDURL></CDGroupMember>\n\
<Example>example here</Example>\n\
<CDComment>Calculus</CDComment>\n\
<CDGroupMember>\n\
<CDName a="b">calculus1</CDName>\n\
<CDURL>http://www.openmath.org/cd/calculus1.ocd</CDURL></CDGroupMember>\n\
<CDComment>Linear Algebra - vector &amp; matrix constructors, those symbols which are dependant of orientation, and in MathML</CDComment>\n\
<CDGroupMember>\n\
<CDName>linalg2</CDName>\n\
<CDURL>http://www.openmath.org/cd/linalg2.ocd</CDURL></CDGroupMember>\n\
<CDComment>Limits of <i>unary</i> functions</CDComment>\n\
<CDGroupMember>\n\
<CDName>limit1</CDName>\n\
<CDURL>http://www.openmath.org/cd/limit1.ocd</CDURL></CDGroupMember>\n\
<CDComment>List constructors</CDComment>\n\
<CDGroupMember>\n\
<CDName>mathmltypes</CDName>\n\
<CDURL>http://www.openmath.org/cd/mathmltypes.ocd</CDURL>\n\
</CDGroupMember>\n\
<CDComment>Minima and maxima</CDComment>\n\
<CDGroupMember>\n\
<CDName>minmax1</CDName>\n\
<CDURL>http://www.openmath.org/cd/minmax1.ocd</CDURL></CDGroupMember>\n\
<CDComment>Multset-theoretic operators and constructors</CDComment>\n\
<CDGroupMember>\n\
<CDName>multiset1</CDName>\n\
<CDURL>http://www.openmath.org/cd/multiset1.ocd</CDURL></CDGroupMember>\n\
<CDComment>Symbols for creating numbers, including some defined constants\n\
(which can be seen as nullary constructors)</CDComment>\n\
<CDGroupMember>\n\
<CDName>nums1</CDName>\n\
<CDURL>http://www.openmath.org/cd/nums1.ocd</CDURL></CDGroupMember>\n\
<CDComment>Symbols for creating piecewise definitions</CDComment>\n\
<CDGroupMember>\n\
<CDName>piece1</CDName>\n\
<CDURL>http://www.openmath.org/cd/piece1.ocd</CDURL></CDGroupMember>\n\
<CDComment>The basic quantifiers forall and exists.</CDComment>\n\
<CDGroupMember>\n\
<CDName>quant1</CDName>\n\
<CDURL>http://www.openmath.org/cd/quant1.ocd</CDURL></CDGroupMember>\n\
<CDComment>Common arithmetic relations</CDComment>\n\
<CDGroupMember>\n\
<CDName>relation1</CDName>\n\
<CDURL>http://www.openmath.org/cd/relation1.ocd</CDURL></CDGroupMember>\n\
<CDComment>Number sets</CDComment>\n\
<CDGroupMember>\n\
<CDName>setname1</CDName>\n\
<CDURL>http://www.openmath.org/cd/setname1.ocd</CDURL></CDGroupMember>\n\
</CDGroup>\n\
';
}

function samplests() {
document.getElementById("cdin").textContent='\n\
<CDSignatures xmlns="http://www.openmath.org/OpenMathCDS" type="sts" cd="set1">\n\
<CDSStatus> fake </CDSStatus>\n\
\n\
<CDSComment>\n\
Based on Set1 STS file\n\
</CDSComment>\n\
\n\
<Signature name="cartesian_product">\n\
<OMOBJ xmlns="http://www.openmath.org/OpenMath"> \n\
  <OMA>\n\
    <OMS cd="sts" name="mapsto"/>\n\
    <OMA>\n\
      <OMS name="nary"/>\n\
      <OMA>\n\
        <OMS cd="sts" name="structure"/>\n\
	<OMV name="Set"/>\n\
      </OMA>\n\
    </OMA>\n\
    <OMA>\n\
      <OMS cd="sts" name="structure"/>\n\
      <OMV name="Set1"/>\n\
    </OMA>\n\
  </OMA>\n\
</OMOBJ>\n\
</Signature>\n\
\n\
<Signature name="map">\n\
<OMOBJ xmlns="http://www.openmath.org/OpenMath"> \n\
 <OMA>\n\
  <OMS cd="sts" name="mapsto"/>\n\
    <OMA>\n\
      <OMS cd="sts" name="mapsto"/>\n\
      <OMS cd="sts" name="Object"/>\n\
      <OMS cd="sts" name="Object"/>\n\
    </OMA>\n\
    <OMV name="Set"/>\n\
    <OMV name="Set"/>\n\
 </OMA>\n\
</OMOBJ>\n\
<CDComment>???</CDComment>\n\
</Signature>\n\
\n\
<Signature name="such that">\n\
<OMOBJ xmlns="http://www.openmath.org/OpenMath"> \n\
 <OMA>\n\
  <OMS cd="sts" name="mapsto"/>\n\
    <OMA>\n\
      <OMS name="structure" cd="sts"/>\n\
      <OMV name="Set"/>\n\
    </OMA>\n\
    <OMA>\n\
      <OMS name="mapsto" cd="sts"/>\n\
      <OMV name="Set"/>\n\
      <OMS name="Boolean" cd="setname2"/>\n\
    </OMA>\n\
    <OMA>\n\
      <OMS name="structure" cd="sts"/>\n\
      <OMV name="Set"/>\n\
    </OMA>\n\
 </OMA>\n\
</OMOBJ>\n\
</Signature>\n\
\n\
<Signature name="emptyset" >\n\
 <OMOBJ xmlns="http://www.openmath.org/OpenMath"> \n\
   <OMV name="Set"/>\n\
 </OMOBJ>\n\
</Signature>\n\
\n\
<Signature name="size" >\n\
<OMOBJ xmlns="http://www.openmath.org/OpenMath"> \n\
 <OMA>\n\
   <OMS name="mapsto" cd="sts" />\n\
    <OMV name="Set" />\n\
    <OMV name="CardinalNumber" />\n\
 </OMA>\n\
</OMOBJ>\n\
</Signature>\n\
\n\
<Signature name="set" >\n\
<OMOBJ xmlns="http://www.openmath.org/OpenMath"> \n\
 <OMA>\n\
  <OMS name="mapsto" cd="sts" />\n\
   <OMA>\n\
    <OMS name="nary" cd="sts" />\n\
     <OMS name="Object" cd="sts" />\n\
   </OMA>\n\
  <OMV name="Set" />\n\
 </OMA>\n\
</OMOBJ>\n\
</Signature>\n\
\n\
<Signature name="intersect" >\n\
<OMOBJ xmlns="http://www.openmath.org/OpenMath"> \n\
 <OMA>\n\
   <OMS name="mapsto" cd="sts" />\n\
    <OMA>\n\
     <OMS name="nassoc" cd="sts" />\n\
     <OMV name="Set" />\n\
    </OMA>\n\
    <OMV name="Set" />\n\
 </OMA>\n\
</OMOBJ>\n\
</Signature>\n\
\n\
<Signature name="union" >\n\
<OMOBJ xmlns="http://www.openmath.org/OpenMath"> \n\
 <OMA>\n\
   <OMS name="mapsto" cd="sts" />\n\
    <OMA>\n\
     <OMS name="nassoc" cd="sts" />\n\
     <OMV name="Set" />\n\
    </OMA>\n\
    <OMV name="Set" />\n\
 </OMA>\n\
</OMOBJ>\n\
</Signature>\n\
\n\
<Signature name="setdiff" >\n\
<OMOBJ xmlns="http://www.openmath.org/OpenMath"> \n\
 <OMA>\n\
   <OMS name="mapsto" cd="sts" />\n\
    <OMV name="Set" />\n\
    <OMV name="Set" />\n\
    <OMV name="Set" />\n\
 </OMA>\n\
</OMOBJ>\n\
</Signature>\n\
\n\
\n\
<Signature name="subset" >\n\
<OMOBJ xmlns="http://www.openmath.org/OpenMath"> \n\
 <OMA>\n\
   <OMS name="mapsto" cd="sts" />\n\
    <OMV name="Set" />\n\
    <OMV name="Set" />\n\
    <OMS cd="setname2" name="Boolean" />\n\
 </OMA>\n\
</OMOBJ>\n\
</Signature>\n\
\n\
\n\
<Signature name="in" >\n\
<OMOBJ xmlns="http://www.openmath.org/OpenMath"> \n\
 <OMA>\n\
   <OMS name="mapsto" cd="sts" />\n\
    <OMS name="Object" cd="sts" />\n\
    <OMV name="Set" />\n\
    <OMS cd="setname2" name="Boolean" />\n\
 </OMA>\n\
</OMOBJ>\n\
</Signature>\n\
\n\
<Signature name="notin" >\n\
<OMOBJ xmlns="http://www.openmath.org/OpenMath"> \n\
 <OMA>\n\
   <OMS name="mapsto" cd="sts" />\n\
    <OMS name="Object" cd="sts" />\n\
    <OMV name="Set" />\n\
    <OMS cd="setname2" name="Boolean" />\n\
 </OMA>\n\
</OMOBJ>\n\
</Signature>\n\
\n\
\n\
<Signature name="prsubset" >\n\
<OMOBJ xmlns="http://www.openmath.org/OpenMath"> \n\
 <OMA>\n\
   <OMS name="mapsto" cd="sts" />\n\
    <OMV name="Set" />\n\
    <OMV name="Set" />\n\
    <OMS cd="setname2" name="Boolean" />\n\
 </OMA>\n\
</OMOBJ>\n\
</Signature>\n\
\n\
<Signature name="notsubset" >\n\
<OMOBJ xmlns="http://www.openmath.org/OpenMath"> \n\
 <OMA>\n\
   <OMS name="mapsto" cd="sts" />\n\
    <OMV name="Set" />\n\
    <OMV name="Set" />\n\
    <OMS cd="setname2" name="Boolean" />\n\
 </OMA>\n\
</OMOBJ>\n\
</Signature>\n\
\n\
<Signature name="notprsubset" >\n\
<OMOBJ xmlns="http://www.openmath.org/OpenMath"> \n\
 <OMA>\n\
   <OMS name="mapsto" cd="sts" />\n\
    <OMV name="Set" />\n\
    <OMV name="Set" />\n\
    <OMS cd="setname2" name="Boolean" />\n\
 </OMA>\n\
</OMOBJ>\n\
</Signature>\n\
\n\
</CDSignatures>\n\
';
}


function samplecd() {
document.getElementById("cdin").textContent='\n\
<CD xmlns="http://www.openmath.org/OpenMathCD">\n\
<CDName> arith1 </CDName>\n\
<CDName> arith11 </CDName>\n\
<CDName> 7 + arith </CDName>\n\
<CDDate> Jan 1, 2000 </CDDate>\n\
<CDReviewDate> 2017-12-25</CDReviewDate>\n\
<CDStatus a="b"> experimental</CDStatus>\n\
<CDComment> Some <b>bold text</b></CDComment>\n\
<CDBase>http://www.openmath.org/cd</CDBase>\n\
<CDURL> htt p://www.openmath.org/cd/arith1.ocd </CDURL>\n\
<CDVersion>99</CDVersion>\n\
<CDRevision> 2b </CDRevision>\n\
<wibble>hmm</wibble>\n\
<CDUses>\n\
  <CDName>set1</CDName>\n\
  <CDName>sat1</CDName>\n\
  <DCName>set2</DCName>\n\
</CDUses>\n\
<CDDefinition>\n\
<Name> lcm </Name>\n\
<Role>application</Role>\n\
<Example>text <OMOBJ> <OMV name="a"/></OMOBJ> more text</Example>\n\
<Example>text <OMOBJ xmlns="http://www.openmath.org/OpenMath"> <OMV name="a"/></OMOBJ> more text</Example>\n\
<Description> \n\
The symbol to represent the n-ary function to return the least common\n\
multiple of its arguments.\n\
</Description>\n\
\n\
<CMP> lcm(a,b) = a*b/gcd(a,b) </CMP>\n\
\n\
<FMP>\n\
<OMOBJ xmlns="http://www.openmath.org/OpenMath" version="2.0" cdbase="http://www.openmath.org/cd">\n\
  <OMA>\n\
    <OMS cd="relation1" name="eq"/>\n\
    <OMA>\n\
      <OMS cd="arith1" name="lcm"/>\n\
      <OMV name="a"/>\n\
      <OMV name="b"/>\n\
    </OMA>\n\
    <OMA>\n\
      <OMS cd="arith1" name="divide"/>\n\
      <OMA>\n\
        <OMS cd="arith1" name="times"/>\n\
	<OMV name="a"/>\n\
	<OMV name="b"/>\n\
      </OMA>\n\
      <OMA>\n\
        <OMS cd="arith1" name="gcd"/>\n\
        <OMV name="a"/>\n\
        <OMV name="b"/>\n\
      </OMA>\n\
    </OMA>\n\
  </OMA>\n\
</OMOBJ>\n\
</FMP>\n\
</CDDefinition>\n\
</CD>\n\
';
}

</script>
 </head>
    <body>


<div>
 <div style="width:5em;float:left;margin-right:1em;text-align:center">
    <a href="/">
    <img src="https://openmath.github.io/public/logo.png" alt="OpenMath" width="100%"/><br/>
    Home
    </a>                
    </div>

    <h1>OpenMath XML Syntax Test Page</h1>
    <div style="max-width:50em">
    <p>The XML to be validated may be edited into the input box below directly,
or by pasting in the text, or by dragging and dropping a file from your system file manager.</p>
    <p>OpenMath, CD, CDGroup and STS files are accepted.</p>
    <p>Alternatively one of the (invalid) examples may be inserted using the buttons below.</p>
   
    <p>
  <input type="button" onclick="samplecd()" value="Sample CD"></input>
  <input type="button" onclick="samplecdg()" value="Sample CDG"></input>
  <input type="button" onclick="sampleom()" value="Sample OM"></input>
  <input type="button" onclick="samplests()" value="Sample STS"></input>
    </p>
    <p>
  <input type="button" onclick="clearcdin()" value="Clear Form"></input>
    </p>

    <p>Use the <b>check</b> button to check the XML.</p>
  </div>
   <p><input id="checkbutton" style="font-size:110%; padding:.5em;" type="button" onclick="checkcd()" value="Check"></input></p>
  <div id="cdinwrapper"
      style="display:inline-block;border: solid thin black;
	     padding:0.5em;
	     vertical-align:top;
             min-height:50em;"
     ondragover="event.stopPropagation(); event.preventDefault();"
     ondrop="event.stopPropagation(); event.preventDefault();
	dodrop(event);"
       >
   <h2>Input</h2>

    <div id="cdin" contenteditable=true spellcheck="false"
    style="overflow:auto;white-space:pre;"
     >
</div>
</div>
<div id="cdoutwrapper"
    style="display:inline-block;border: solid black thin; background-color:#EEE;
padding:0.5em; min-height:50em;
	   overflow:auto;vertical-align:top">
 <h2>Output <span id="errcount"></span></h2>
 <div id="cdout">
 </div>
</div>
<script>
//samplecd();
</script>
 </body>
</html>
